# 股票分析系统架构图

## 系统概览

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                            A股和ETF股票分析系统                                    │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 数据流架构

```
┌─────────────────┐
│  Stock Data Tool │  ← 股票数据获取工具
│  (股票数据工具)   │
└─────────┬───────┘
          │
          ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│                           Stock Analysis Workflow                               │
│                            (股票分析工作流)                                      │
└─────────────────┬───────────────────────────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│  📊 分析师团队 (Analysts) - 并行执行 7个分析师                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │ CompanyOverview │  │   MarketAnalyst │  │ SentimentAnalyst│  │   NewsAnalyst   │ │
│  │    Analyst      │  │   (市场分析师)   │  │  (情绪分析师)    │  │  (新闻分析师)    │ │
│  │ (公司概述分析师) │  │                 │  │                 │  │                 │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
│                                                                                 │
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐                   │
│  │FundamentalsAnalyst│ │ShareholderAnalyst│ │ ProductAnalyst  │                   │
│  │ (基本面分析师)    │ │ (股东分析师)     │ │ (产品分析师)     │                   │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘                   │
└─────────────────────────────────────────────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│  🔬 研究员团队 (Researchers) - 并行执行 2个研究员                                 │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐                    ┌─────────────────┐                     │
│  │ BullResearcher  │                    │ BearResearcher  │                     │
│  │ (看涨研究员)     │                    │ (看跌研究员)     │                     │
│  └─────────────────┘                    └─────────────────┘                     │
└─────────────────────────────────────────────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│  ⚠️ 风险管理团队 (Risk Management) - 并行执行 4个风险分析师                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐  ┌─────────────────┐ │
│  │AggressiveRisk   │  │  SafeRisk       │  │ NeutralRisk     │  │  RiskManager    │ │
│  │   Analyst       │  │   Analyst       │  │   Analyst       │  │ (风险经理)      │ │
│  │(激进风险分析师)  │  │(保守风险分析师)  │  │(中性风险分析师)  │  │                 │ │
│  └─────────────────┘  └─────────────────┘  └─────────────────┘  └─────────────────┘ │
└─────────────────────────────────────────────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│  👔 管理层 (Managers) - 串行执行 2个管理者                                        │
├─────────────────────────────────────────────────────────────────────────────────┤
│  ┌─────────────────┐                    ┌─────────────────┐                     │
│  │ ResearchManager │ ──────────────────▶ │     Trader      │                     │
│  │ (研究经理)      │                    │   (交易员)      │                     │
│  └─────────────────┘                    └─────────────────┘                     │
└─────────────────────────────────────────────────────────────────────────────────┘
                  │
                  ▼
┌─────────────────────────────────────────────────────────────────────────────────┐
│  📋 最终综合报告 (Final Comprehensive Report)                                    │
├─────────────────────────────────────────────────────────────────────────────────┤
│  • 分析师团队分析结果                                                             │
│  • 研究员团队分析结果                                                             │
│  • 风险管理团队分析结果                                                           │
│  • 管理层分析结果                                                               │
│  • 综合投资建议                                                                 │
│  • 交易策略建议                                                                 │
└─────────────────────────────────────────────────────────────────────────────────┘
```

## 工作流程

### 第一阶段：分析师团队并行分析

- 7个分析师同时执行，各自负责不同维度的分析
- 包括：公司概述、市场表现、情绪分析、新闻分析、基本面分析、股东分析、产品分析

### 第二阶段：研究员团队并行分析

- 2个研究员基于分析师结果进行看涨/看跌分析
- 提供多角度的投资观点

### 第三阶段：风险管理团队并行分析

- 3个风险分析师从不同风险偏好角度分析
- 风险经理统筹制定综合风险管理策略

### 第四阶段：管理层综合决策

- 研究经理整合所有分析结果
- 交易员制定具体交易策略

### 第五阶段：生成综合报告

- 整合所有团队的分析结果
- 提供最终的投资建议和交易策略

## 支持的股票类型

### A股股票

- 主板股票 (如: 000001.SZ - 平安银行)
- 创业板股票 (如: 300001.SZ - 特锐德)
- 科创板股票 (如: 688001.SH - 华兴源创)

### ETF基金

- 宽基ETF (如: 510300.SH - 沪深300ETF)
- 行业ETF (如: 512880.SH - 证券ETF)
- 主题ETF (如: 515050.SH - 5G ETF)

## 技术特点

1. **并行处理**: 分析师团队和研究员团队采用并行执行，提高分析效率
2. **多维度分析**: 从7个不同维度全面分析股票
3. **风险导向**: 专门的风险管理团队确保投资安全
4. **专业分工**: 每个Agent都有明确的专业职责
5. **综合决策**: 管理层整合所有分析结果，提供最终建议
6. **可扩展性**: 易于添加新的分析师或分析维度

## 使用方式

```typescript
// 全面分析
const result = await mastra.workflows.stockAnalysisWorkflow.execute({
  stockCode: "000001.SZ",
  analysisType: "comprehensive",
})

// 快速分析
const result = await mastra.workflows.stockAnalysisWorkflow.execute({
  stockCode: "510300.SH",
  analysisType: "quick",
})

// 风险导向分析
const result = await mastra.workflows.stockAnalysisWorkflow.execute({
  stockCode: "000002.SZ",
  analysisType: "risk-focused",
})
```
